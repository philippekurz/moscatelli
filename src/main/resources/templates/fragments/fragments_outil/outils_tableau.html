<!DOCTYPE html>
<html lang="fr" xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity5">

<div th:fragment="outils_tableau">
    <div class="text-center" >
        <h1 sec:authorize="hasAnyRole('ROLE_ADMINISTRATEUR', 'ROLE_MAGASINIER')" th:if="${etalonnee}">Gestion des appareil etalonnés</h1>
        <h1 sec:authorize="hasAnyRole('ROLE_ADMINISTRATEUR', 'ROLE_MAGASINIER')" th:if="${!etalonnee}">Gestion des outils</h1>

        <h1 sec:authorize="hasAnyRole('ROLE_VISITEUR')" th:if="${etalonnee}">Liste des appareil etalonnés</h1>
        <h1 sec:authorize="hasAnyRole('ROLE_VISITEUR')" th:if="${!etalonnee}">Liste des outils</h1>

        <!-------------------------------------------------------------- Début du tableau ----------------------------------------------------------------->
        <table class="table table-responsive">
            <thead>
            <tr>

                <th scope="col"><a class="tri asc"  th:href="@{/outils}">Désignation</a></th>
                <th scope="col"><a class="tri desc"  th:href="@{/outils}">Marque</a></th>
                <th scope="col"><a class="tri"  th:href="@{/outils}">Modèle</a></th>
                <th scope="col"><a class="tri"  th:href="@{/outils}">Numéro de série</a></th>
                <th scope="col"><a class="tri"  th:href="@{/outils}">Puissance</a></th>
                <th scope="col" th:if="${etalonnee}" >Capacité</th>
                <th scope="col">Repère</th>
                <th scope="col" th:if="${etalonnee}">Périodicité</th>
                <th scope="col">Fournisseur</th>
                <th scope="col">État</th>
                <th scope="col">Statut</th>


<!--                <th scope="col">ES</th>-->
                <th scope="col" colspan="5"></th>
            </tr>
            </thead>
            <!---------------------------- Contenu du tableau ----------------------------------->
            <tbody>
            <th:block th:each="outil : ${Outils}">
<!--                <tr th:class="${outil.esEnCours.id==null && (outil.typeStatut eq T(fr.hellocorp.projetmoscatelli.admin.outil.Outil.TypeStatut).Fonction) ? 'vert' : 'orange'}">-->
                <tr th:class="${outil.classCouleur}">
                    <td>[[${outil.designation}]]</td>
                    <td>[[${outil.marque}]]</td>
                    <td>[[${outil.modele}]]</td>
                    <td>[[${outil.numero_de_serie}]]</td>
                    <td>[[${outil.puissance}]]</td>
                    <td th:if="${etalonnee}" >[[${outil.capacite}]]</td>
                    <td>[[${outil.repere}]]</td>
                    <td th:if="${etalonnee}" >[[${outil.periodicite}]]</td>
                    <td>[[${outil.fournisseur}]]</td>
                    <td>[[${outil.etat}]]</td>
                    <td>[[${outil.typeStatut}]]</td>


<!--                    <td>[[${outil.esEnCours.id}]]</td>-->




                    <td><a th:if="${outil.esEnCours.id}!=null"
                           sec:authorize="hasAnyRole('ROLE_ADMINISTRATEUR', 'ROLE_MAGASINIER')"
                           type="button" data-bs-toggle="modal"  th:attr="data-bs-target='#retourModal'+*{outil.id}" ><i class="bi bi-box-arrow-in-left mx-1"></i></a></td>

                    <td><a th:if="${outil.esEnCours.id==null && (outil.typeStatut eq T(fr.hellocorp.projetmoscatelli.admin.outil.Outil.TypeStatut).Fonction)}"
                           sec:authorize="hasAnyRole('ROLE_ADMINISTRATEUR', 'ROLE_MAGASINIER')"
                           type="button" data-bs-toggle="modal" th:attr="data-bs-target='#sortieModal'+*{outil.id}"><i class="bi bi-box-arrow-in-right mx-1"></i></a></td>



                    <td><a sec:authorize="hasAnyRole('ROLE_ADMINISTRATEUR', 'ROLE_MAGASINIER')" type="button" data-bs-toggle="modal" th:attr="data-bs-target='#editModal'+*{outil.id}"><i class="bi bi-pencil-fill mx-1"></i></a></td>
                    <td><a sec:authorize="hasAnyRole('ROLE_ADMINISTRATEUR', 'ROLE_MAGASINIER')" type="button" data-bs-toggle="modal"  th:attr="data-bs-target='#deleteModal'+*{outil.id}"><i class="bi bi-trash-fill mx-1"></i></a></td>
                    <td><a sec:authorize="hasAnyRole('ROLE_ADMINISTRATEUR', 'ROLE_MAGASINIER')" type="button" data-bs-toggle="modal"  th:attr="data-bs-target='#historyModal'+*{outil.id}"><i class="bi bi-clock-history mx-1"></i></a>


    <!---------------------------------------------------------- Modal edit / delete ------------------------------------------------------>

                        <div th:replace="fragments/fragments_outil/outils_edit.html :: outils_edit"></div>
                        <div th:replace="fragments/fragments_outil/outils_delete.html :: outils_delete"></div>

    <!---------------------------------------------------------- Modal entree sortie ------------------------------------------------------>

                        <div th:replace="fragments/fragments_outil/outils_entree_sortie.html :: outils_entree_sortie"></div>
                        <div th:replace="fragments/fragments_outil/outils_history.html :: outils_history"></div>
                    </td>

<!-------------------------------------------------------- Fermeture du tableau ------------------------------------------------------>
                </tr>
            </th:block>
            </tbody>
        </table>
    </div>
</div>